var app=angular.module("businessCardMaker",["ngRoute","ngTouch","angular-meditor"]).config(["$routeProvider",function(a){"use strict";a.when("/",{templateUrl:"views/cardeditor.html",controller:"MainCtrl",reloadOnSearch:!1}).otherwise({redirectTo:"/?theme=0"}),analytics.page()}]);app.run(function(){}),app.directive("fileread",[function(){"use strict";return{scope:{fileread:"="},link:function(a,b){b.bind("change",function(b){a.$apply(function(){a.fileread=b.target.files[0]})})}}}]),app.controller("MainCtrl",["$rootScope","$scope","$routeParams","$location","$timeout",function(a,b,c,d,e){"use strict";var f=b.model={};f.iOS=/(iPad|iPhone|iPod)/g.test(navigator.userAgent),f.cardPictureFile="",f.cardPicture="",f.generatingCard=!1,f.generatingPdf=!1,f.imageData="",f.imageFilename="bizcardmaker-com.jpg",f.pdfData="",f.pdfFilename="bizcardmaker-com.pdf",b.$on("$routeUpdate",function(){f.activeTheme=parseInt(c.theme,10)||0}),b.$broadcast("$routeUpdate"),f.themes=[{name:"simple-black"},{name:"simple-white"},{name:"simple-blue"},{name:"simple-dark-blue"},{name:"simple-turquoise"},{name:"simple-red"},{name:"black-corners"},{name:"black-white"},{name:"diagonals"},{name:"black-border"},{name:"line-one"},{name:"asphalt-half"}],b.$watch("model.cardPictureFile",function(){if(f.cardPictureFile){var a=/image.*/;if(f.cardPictureFile.type.match(a)){var b=new FileReader;b.onload=function(){e(function(){f.cardPicture=b.result})},b.readAsDataURL(f.cardPictureFile)}else window.alert("File not supported!")}});var g=document.querySelector(".card-preview").querySelectorAll("*");angular.forEach(g,function(a){a.removeAttribute("style")});var h=function(a){var b,c,d,e=a.querySelectorAll("[contenteditable]");angular.forEach(e,function(a){b=a.querySelectorAll("*"),c=window.getComputedStyle(a,null),angular.forEach(b,function(a){d=window.getComputedStyle(a,null),a.style.fontSize=parseInt(d.fontSize)/parseInt(c.fontSize)+"em"})})};b.DownloadPdf=function(){var a=$(".card-preview").get(0);if(h(a),f.generatingCard=!0,f.generatingPdf=!0,f.iOS)var b=window.open("/generating.html","_blank");html2canvas(a,{letterRendering:!0,onrendered:function(a){e(function(){f.generatingCard=!1,f.generatingPdf=!1});for(var c=new jsPDF,d=a.toDataURL("image/jpeg",1),g=0;2>g;g++)for(var h=0;5>h;h++)c.addImage(d,"JPEG",10+93*g,10+55*h,92,54);f.iOS?b.location.href=c.output("dataurlstring"):c.save(f.pdfFilename)}}),analytics.track("Download PDF",{category:"Download",label:f.themes[f.activeTheme].name})},b.DownloadPicture=function(){var a=$(".card-preview").get(0);if(h(a),f.generatingCard=!0,f.iOS)var b=window.open("/generating.html","_blank");html2canvas(a,{letterRendering:!0,onrendered:function(a){e(function(){f.generatingCard=!1}),f.iOS?(f.imageData=a.toDataURL("image/jpeg",1),b.location.href=f.imageData):a.toBlob(function(a){saveAs(a,f.imageFilename)},"image/jpeg")}}),analytics.track("Download picture",{category:"Download",label:f.themes[f.activeTheme].name})}}]),angular.module("businessCardMaker").run(["$templateCache",function(a){"use strict";a.put("views/cardeditor.html",'<section class="themes-box">\n\n	<div class="row">\n		<div class="large-12 columns">\n			<h2>Choose a design</h2>\n		</div>\n	</div>\n\n	<div class="themes-row" id="js-themes">\n\n		<a ng-href="#/?theme={{ $index }}" class="theme-item {{ theme.name }}-thumb" ng-repeat="theme in model.themes" ng-class="{ active: $index == model.activeTheme }">\n			<div class="theme-preview-container">\n				<div class="theme-preview"></div>\n			</div>\n		</a>\n\n	</div>\n\n</section>\n\n<section class="card-editor">\n\n	<div class="row">\n\n		<div class="large-8 columns">\n\n			<h2>Customize your business card</h2>\n			<p>\n				Just click on any of the details on the card, to edit them. <br>\n				Double click or select the text to change its style, size or font.\n			</p>\n\n			<div class="card-edit-container" ng-class="{ \'card-big\': model.generatingCard, \'card-print\': model.generatingPdf, \'ios\': model.iOS }">\n\n				<div class="card-container" id="js-card-container">\n					<div class="card-preview {{ model.themes[model.activeTheme].name }}">\n\n						<input type="file" id="picture-upload" class="file-upload" fileread="model.cardPictureFile">\n						<label for="picture-upload" class="card-picture" ng-class="{ \'no-picture\': !model.cardPicture }" title="Click to upload your own logo">\n\n							<i class="fa fa-picture-o"></i>\n							<span>Upload your logo</span>\n\n							<img ng-src="{{ model.cardPicture }}">\n\n						</label>\n\n						<ul class="vcard">\n\n							<li class="person" meditor>\n								<p class="fn">\n									John Doe\n								</p>\n								<p class="title">\n									Position\n								</p>\n							</li>\n\n							<li class="details" meditor>\n								<p class="org">\n									Organization\n								</p>\n								<p>\n									<span class="locality">City</span>,\n									<span class="state">State</span>\n								</p>\n								<p class="tel">\n									(123) 555-1234\n								</p>\n							</li>\n\n							<li class="email" meditor>\n								john.doe@cmail.com\n							</li>\n\n							<li class="url" meditor>\n								www.john-doe.com\n							</li>\n						</ul>\n\n					</div>\n				</div>\n\n\n				<ul class="button-group download-buttons">\n					<li>\n\n						<form class="download-form">\n							<button type="button" class="button" id="js-download-button" ng-click="DownloadPdf()">\n								<i class="fa fa-file-text"></i>\n								Download PDF\n								<small>For printing at home, or at your local printer. </small>\n							</button>\n						</form>\n\n					</li>\n					<li>\n\n						<form class="download-form">\n							<button type="button" class="button secondary" id="js-download-picture-button" ng-click="DownloadPicture()">\n								<i class="fa fa-picture-o"></i>\n								Download picture\n\n								<small>For posting online or sharing with other people. </small>\n							</button>\n						</form>\n\n					</li>\n				</ul>\n\n			</div>\n\n		</div>\n\n		<div class="large-4 columns">\n\n			<div class="panel buy-block">\n				<h4>\n					Want to use <br>\n					<strong>Business Card Maker</strong><br>\n					in your app or website?\n				</h4>\n				<p>Contact me at <a href="mailto:contact@bizcardmaker.com">contact@bizcardmaker.com</a> for more details. </p>\n			</div>\n\n		</div>\n\n	</div>\n\n</section>\n\n<ol class="joyride-list" data-joyride>\n	<li data-id="js-themes" data-text="Next">\n		<p>Select one of the available templates for your business card. </p>\n	</li>\n	<li data-id="js-card-container" data-text="Next">\n		<p>Edit all of the details on the business card by simply clicking on them. </p>\n		<p>You can also upload your own logo or picture, by clicking the picture icon. </p>\n	</li>\n	<li data-id="js-download-button" data-button="Next">\n		<p>Once you\'re done editing and your business card looks just right, simply press the <strong>Download PDF</strong> button and print the resulting PDF. </p>\n	</li>\n	<li data-id="js-download-picture-button" data-button="Done">\n		<p>You can also download your business card as a picture, if you want to share it online with others. </p>\n	</li>\n</ol>\n\n')}]);